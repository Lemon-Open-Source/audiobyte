<!DOCTYPE html>
<html>
<head>
  <title>Audio Byte Transmitter</title>
  <style>
    body { font-family: sans-serif; background: #111; color: #eee; padding: 20px; }
    textarea { width: 100%; height: 100px; }
    button { padding: 10px 20px; font-size: 16px; }
  </style>
</head>
<body>
  <h1>ðŸ”Š Loud Audio Byte Communicator</h1>
  <p>Enter text to transmit via sound (audible byte frequency modulation):</p>
  <textarea id="textInput" placeholder="Enter message here..."></textarea><br><br>
  <button onclick="sendText()">Transmit</button>

  <script>
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    function playTone(frequency, duration) {
      return new Promise((resolve) => {
        const oscillator = audioCtx.createOscillator();
        const gainNode = audioCtx.createGain();
        oscillator.frequency.value = frequency;
        oscillator.type = 'sine';

        gainNode.gain.setValueAtTime(0, audioCtx.currentTime);
        gainNode.gain.linearRampToValueAtTime(0.5, audioCtx.currentTime + 0.01);
        gainNode.gain.linearRampToValueAtTime(0, audioCtx.currentTime + duration / 1000 - 0.01);

        oscillator.connect(gainNode);
        gainNode.connect(audioCtx.destination);

        oscillator.start();
        oscillator.stop(audioCtx.currentTime + duration / 1000);

        oscillator.onended = resolve;
      });
    }

    function byteToFrequency(byte) {
      return 1000 + byte * 15;  // Map 0-255 to 1000â€“4845 Hz
    }

    async function sendBytes(bytes) {
      // Start frame marker frequency around 10,000 Hz (receiver expects 9900-10050 Hz)
      await playTone(10000, 150);

      for (let byte of bytes) {
        const freq = byteToFrequency(byte);
        await playTone(freq, 100);
        await new Promise(r => setTimeout(r, 20)); // pause between tones
      }

      // End frame marker frequency around 8900 Hz (receiver expects 8800-8950 Hz)
      await playTone(8900, 150);
    }

    function stringToBytes(text) {
      return new TextEncoder().encode(text);
    }

    function sendText() {
      const text = document.getElementById("textInput").value;
      if (!text) {
        alert("Please enter some text to transmit.");
        return;
      }
      sendBytes(stringToBytes(text));
    }
  </script>
</body>
</html>
